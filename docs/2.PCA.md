## PCA

### Definition of PCA

Input $A\in R^{n\times d}$, find a matrix A, where $rank(A)=k$, s.t. $\min\|A-A_k\|_F$
$A=\left[\begin{array}{c}
P_1\\P_2\\\vdots\\P_n
\end{array}\right]$, $A_k=\left[\begin{array}{c}
\pi{(P_1)}^T\\
\pi{(P_2)}^T\\
\vdots\\
\pi{(P_n)}^T
\end{array}\right]$

#### When k = 0
即用一个点近似所有数据点的分布, $\forall i, \pi(P_i)=q$, then target becomes
$$\min\sum\limits_{i=1}^n\|P_i-q\|^2$$
则最优解是 $q=\frac{1}{n}\sum\limits_{i=1}^nP_i$
反证法: 令 $\mu =\frac{1}{n}\sum\limits_{i=1}^nP_i$, 假设 $q\not=\mu$, 
$$\begin{aligned}
\sum\limits_{i=1}^n\|P_i-q\|^2 &= \sum\limits_{i=1}^n\|P_i-\mu+\mu-q\|^2\\
&=\sum\limits_{i=1}^n\left(\|P_i-\mu\|^2-2\left< P_i-\mu, \mu-q\right>+\|\mu-q\|^2\right)\\
&=\sum\limits_{i=1}^n\|P_i-\mu\|^2+n\|\mu-q\|^2\\
\end{aligned}$$
此时 $\min\sum\limits_{i=1}^n\|P_i-q\|^2\Leftrightarrow q=\mu$ 矛盾.

#### When k $\ge$ 1
##### 最优超平面必然包含均值 $\mu$
反证法: 假设一个新平面 $F'=F+\mu-\pi(\mu)$ 更优. 记 $\alpha$ 为空间 F 中的任一向量在正交补空间 $F^{\perp}$ 的投影, 则有 $$\sum\limits_{i=1}^n\|P_i-\pi(P_i)\|^2=\sum\limits_{i=1}^n\|\alpha(P_i)-\alpha(F)\|^2$$
因为 $\alpha(F')=\frac{1}{n}\sum\limits_{i=1}^n\alpha(P_i), 由 $k=0$ 时的讨论可知 $\alpha(F)=\alpha(F')$, 于是 $F=F'$, 从而 $\mu\inF$.
##### 确定 k 维超平面位置
###### 若 k=1
即用一条直线 $t_1$ 去近似所有数据分布, 由勾股定理:
$$\min\sum\limits_{i=1}^n\|P_i-\pi(P_i)\|^2=\sum\limits_{i=1}^n\|P_i\|^2-\sum\limits_{i=1}^n(\left< P_i,t_i\right>)^2$$, 故优化问题等价于$$\max\limits_{\|t_i\|=1}\sum\limits_{i=1}^n(\left< P_i,t_i\right>)^2=\max\limits_{\|t_i\|=1}\|At_1\|_F^2$$
对 $A$ 做 SVD 分解, 即 $A=USV^T$, 其中 $U$ 和 $V$ 都是正交矩阵, $S$ 为对角矩阵. (注意这里正交变换保证了保距同构的性质.)